---
title: Cloud Functions
sidebar_label: Usage
---

To start using Cloud Functions package within your project, import it at the top of your project files:

```dart
import 'package:cloud_functions/cloud_functions.dart';
```

Before using Cloud Functions, you must first have ensured you have [initialized FlutterFire](overview#initializing-flutterfire).

To create a new Cloud Functions instance, call the [`instance`](!cloud_functions.CloudFunctions.instance) getter on [`CloudFunctions`](!cloud_functions.CloudFunctions):

```dart
CloudFunctions cloudFunctions = CloudFunctions.instance;
```

By default, this allows you to interact with Cloud Functions using the default Firebase App used whilst installing Cloud Functions on your
platform. If however you'd like to use Cloud Functions with a secondary Firebase App, use the [`instanceFor`](!cloud_functions.CloudFunctions.instanceFor) method:

```dart
  FirebaseApp secondary = Firebase.app('Secondary');
  CloudFunctions secondaryApp = CloudFunctions.instanceFor(app: secondary);
```

## Calling Endpoints

Assuming we have a deployed function named `listFruit`, we can call the Cloud Function using the `httpsCallable` method.
For example:

```javascript title="Deployed Function"
const functions = require('firebase-functions');

exports.listFruit = functions.https.onCall((data, context) => {
   return ["Apple", "Banana", "Cherry", "Date", "Fig", "Grapes"]
});
```

Within Flutter, the function can be called, and the results accessed:

```dart
import 'package:cloud_functions/cloud_functions.dart';

Future<void> getFruit() async {
  HttpsCallable callable = CloudFunctions.instance.httpsCallable('listFruit');
  final results = await callable();
  List fruit = results.data;  // ["Apple", "Banana", "Cherry", "Date", "Fig", "Grapes"]
}
```

## Emulator Usage

If you are using the local Cloud Functions emulators, then it is possible to connect to these using the `useFunctionsEmulator` method.
Ensure you pass the correct port on which the Firebase emulator is running on.

> On Android, to reference localhost, use the 10.0.2.2 IP address instead.

```dart
CloudFunctions.instance
  .useFunctionsEmulator(origin: 'http://10.0.2.2:5000')
  .httpsCallable('myCloudFunction');
```

If you are targeting apps using Android 8.0+, the platform will block the http endpoint.  The simplest solution is to change
this in your **debug** builds by adding the following to your `app/AndroidManifest.xml` file:

```xml
<application
  android:usesCleartextTraffic="true"
/>
```

If you are concerned about security, you can set a more advanced [per-host network security file](https://developer.android.com/training/articles/security-config)
